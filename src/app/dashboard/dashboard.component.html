<div class="first-div">
  <button type="button" *ngIf="isAdmin" class="btn btn-success float-start me-2" (click)="AddCluster()"><i class="fas fa-plus fa-fw"></i> Add</button>
  <button type="button" class="btn btn-danger float-end me-2" (click)="logout()"><i class="fas fa-sign-out-alt fa-fw"></i> Logout</button>
</div>
<div class="secound-div">
  <table class="table table-striped table-hover">
    <thead>
      <tr>
        <th scope="col">#</th>
        <th scope="col">Group Name</th>
        <th scope="col" *ngIf="isAdmin">Group Action</th>
        <th scope="col">Cluster Name</th>
        <th scope="col">Env Name</th>
        <th scope="col">Action</th>
      </tr>
    </thead>
    <tbody *ngFor="let data of responseData ;let i =index">
        <tr>
          <th [attr.rowspan]="clusterCount">{{i + 1}}</th>
          <th [attr.rowspan]="clusterCount">{{data.groupName}}</th>
          <th [attr.rowspan]="clusterCount" *ngIf="isAdmin">
            <button type="button" (click)="editData(data)" class="btn btn-secondary me-2"><i class="fas fa-edit fa-fw"></i> Edit</button>
            <button type="button" (click)="deleteData(data)" class="btn btn-danger me-2"><i class="fas fa-trash fa-fw"></i> Delete</button>
          </th>
        </tr>
        <tr *ngFor="let clustersData of data.clusters">
          <td>{{clustersData.clusterName}}</td>
          <td>{{clustersData.envName}}</td>
          <td>
            <button type="button" (click)="getCluster(data._id, clustersData._id , clustersData.clusterName)" class="btn btn-primary me-2" data-bs-toggle="modal" data-bs-target="#clusterModal"><i class="fas fa-folder-open"></i> Cluster</button>
            <img src="assets/img/k8s.svg" id="icon" alt="Logo"/>
          </td>
        </tr>
    </tbody>
  </table>
</div>
  
<!-- Modal -->
<div class="modal fade" id="clusterModal" tabindex="-1" aria-labelledby="clusterModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-fullscreen">
    <div class="modal-content">
      <div class="modal-header">
        <h1 class="modal-title" id="clusterModalLabel">{{clusterName}}</h1>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="third-div">
        <table class="table table-hover">
          <thead>
            <tr>
              <th scope="col"><input class="form-check-input" type="checkbox" value="" id="flexCheckDefault"></th>
              <th scope="col">#</th>
              <th scope="col">APP</th>
              <th scope="col">PNAME</th>
              <!-- <th scope="col">STATUS</th> -->
              <th scope="col">RESTARTS</th>
              <th scope="col">NODE</th>
              <th scope="col">AGE</th>
              <th scope="col">REDAY</th>
              <th scope="col">Pod Logs Action</th>
              <th scope="col">App Logs Action</th>
            </tr>
          </thead>
            <tbody *ngFor="let data of clusterData ;let i =index ;let l = count">
              <tr>
                <th [attr.rowspan]="l"><input class="form-check-input" type="checkbox" value="" id="flexCheckDefault"></th>
                <th [attr.rowspan]="l">{{i + 1}}</th>
                <th [attr.rowspan]="l">{{data.APP}}</th>
                  <td>{{data.PNAME}}</td>
                  <!-- <td>{{data.STATUS}}</td> -->
                  <td>{{data.RESTARTS}}</td>
                  <td>{{data.NODE}}</td>
                  <td>{{data.AGE}}</td>
                  <td *ngIf="data.READY; else Error">Running</td>
                  <ng-template #Error>
                    <td>Error...</td>
                  </ng-template>
                  <td>
                    <div class="dropdown">
                      <button class="btn btn-info dropdown-toggle me-2" type="button" id="dropdownMenuButton1" data-bs-toggle="dropdown" aria-expanded="false">
                        <!-- <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true" *ngIf="isVisible"></span> -->
                        <i class="fas fa-eye"></i> PLogs
                      </button>
                      <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton1">
                        <li><a class="dropdown-item" (click)="viewPodLogs(data.PNAME, '1h')">View 1H</a></li>
                        <li><a class="dropdown-item" (click)="viewPodLogs(data.PNAME, '2h')">View 2H</a></li>
                        <li><a class="dropdown-item" (click)="viewPodLogs(data.PNAME, '12h')">View 12H</a></li>
                        <li><a class="dropdown-item" (click)="viewPodLogs(data.PNAME, '24h')">View 24H</a></li>
                        <li><a class="dropdown-item" (click)="viewPodLogs(data.PNAME, '48h')">View 48H</a></li>
                        <li><a class="dropdown-item" (click)="viewPodLogs(data.PNAME, '72h')">View 72H</a></li>
                        <li><a class="dropdown-item" (click)="viewPodLogs(data.PNAME)" *ngIf="isAdmin">View Full Logs</a></li>
                      </ul>
                      <button class="btn btn-success dropdown-toggle me-2" type="button" id="dropdownMenuButton2" data-bs-toggle="dropdown" aria-expanded="false">
                        <!-- <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true" *ngIf="isVisible"></span> -->
                        <i class="fas fa-download"></i> PLogs
                      </button>
                      <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton2">
                        <li><a class="dropdown-item" (click)="downloadPodLogs(data.PNAME, '1h')">Download 1H</a></li>
                        <li><a class="dropdown-item" (click)="downloadPodLogs(data.PNAME, '2h')">Download 2H</a></li>
                        <li><a class="dropdown-item" (click)="downloadPodLogs(data.PNAME, '12h')">Download 12H</a></li>
                        <li><a class="dropdown-item" (click)="downloadPodLogs(data.PNAME, '24h')">Download 24H</a></li>
                        <li><a class="dropdown-item" (click)="downloadPodLogs(data.PNAME, '48h')">Download 48H</a></li>
                        <li><a class="dropdown-item" (click)="downloadPodLogs(data.PNAME, '72h')">Download 72H</a></li>
                        <li><a class="dropdown-item" (click)="downloadPodLogs(data.PNAME)" *ngIf="isAdmin">Download Full Logs</a></li>
                      </ul>
                    </div>
                  </td>
                  <td>
                    <div class="dropdown">
                      <button class="btn btn-info dropdown-toggle me-2" type="button" id="dropdownMenuButton3" data-bs-toggle="dropdown" aria-expanded="false">
                        <!-- <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true" *ngIf="isVisible"></span> -->
                        <i class="fas fa-eye"></i> ALogs
                      </button>
                      <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton3">
                        <li><a class="dropdown-item" (click)="viewAppLogs(data.APP, '100')">View 100 Lines</a></li>
                        <li><a class="dropdown-item" (click)="viewAppLogs(data.APP, '1000')">View 1000 Lines</a></li>
                        <li><a class="dropdown-item" (click)="viewAppLogs(data.APP, '10000')">View 10000 Lines</a></li>
                        <li><a class="dropdown-item" (click)="viewAppLogs(data.APP, '100000')">View 100000 Lines</a></li>
                        <li><a class="dropdown-item" (click)="viewAppLogs(data.APP, '500000')">View 500000 Lines</a></li>
                        <li><a class="dropdown-item" (click)="viewAppLogs(data.APP)" *ngIf="isAdmin">View Full App Logs</a></li>
                      </ul>
                      <button class="btn btn-success dropdown-toggle me-2" type="button" id="dropdownMenuButton4" data-bs-toggle="dropdown" aria-expanded="false">
                        <!-- <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true" *ngIf="isVisible"></span> -->
                        <i class="fas fa-download"></i> ALogs
                      </button>
                      <ul class="dropdown-menu" aria-labelledby="dropdownMenuButton4">
                        <li><a class="dropdown-item" (click)="downloadAppLogs(data.APP, '100')">Download 100 Lines</a></li>
                        <li><a class="dropdown-item" (click)="downloadAppLogs(data.APP, '1000')">Download 1000 Lines</a></li>
                        <li><a class="dropdown-item" (click)="downloadAppLogs(data.APP, '10000')">Download 10000 Lines</a></li>
                        <li><a class="dropdown-item" (click)="downloadAppLogs(data.APP, '100000')">Download 100000 Lines</a></li>
                        <li><a class="dropdown-item" (click)="downloadAppLogs(data.APP, '500000')">Download 500000 Lines</a></li>
                        <li><a class="dropdown-item" (click)="downloadAppLogs(data.APP)" *ngIf="isAdmin">Download Full App Logs</a></li>
                      </ul>
                    </div>
                  </td>
                </tr>
            </tbody>
        </table>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>